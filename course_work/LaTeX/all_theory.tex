\documentclass[a4paper,14pt]{extarticle}
\usepackage[T2A]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage[russian]{babel}

\usepackage[dvips]{graphicx}
\usepackage{color}
\usepackage[dvips]{hyperref}

\usepackage{setspace}
\usepackage{indentfirst}
\usepackage{textcomp}
\usepackage{ifthen}
\usepackage{calc}

\usepackage{amssymb}

\usepackage[cache=false]{minted}


\begin{document}
\newpage

\part{Теоретическая}
\section{Задание \textnumero 1}

Предположим, что вам необходимо предсказать последовательность $Y_1, Y_2, \ldots \in {0, 1}$ независимых и одинаково распределенных случайных величин с неизвестным распределением. Пусть $D = [0, 1]$, $l(x, y) = |x - y|$. Придумайте свой алгоритм для решения этой задачи. Оцените средний ожидаемый регрет своего алгоритма по сравнению с двумя экспертами, один из которых всегда выбирает исход $0$, а другой — исход $1$. Сравните результат со средним ожидаемым регретом алгоритма взвешенного большинства, который не обладает информацией о том, что исходы независимы и одинаково распределены. Можно ли с течением времени для алгоритма взвешенного большинства сделать средний ожидаемый регрет сколь угодно малым? Какой алгоритм оказался лучше в итоге?

\subsection{Решение}

Предлагаемый алгоритм заключается в том, чтобы на каждом шаге выбирать исход, который наиболее вероятен, исходя из имеющейся истории. То есть на каждом шаге алгоритм выбирает исход $\hat{y_t}$, который минимизирует ожидаемый регрет $E[l(y_t,\hat{y_t})]$ по всем возможным исходам $\hat{y_t}$. Формально, для каждого $t\geq 1$:

$$\hat{y_t} = argmin_{y \in {0, 1}}\mathbb{E}\left[l(y, y_t|y_1, \ldots, y_{t-1})\right]$$

Ожидаемый регрет для данного алгоритма можно оценить следующим образом:
$$R(T) = \mathbb{E}\left[\sum_{t=1}^{T} l\left(y, \hat{y_t}\right)\right] \le \sum_{t=1}^{T}\mathbb{E}\left[l\left(y, \hat{y_t}\right)\right]$$

Далее оценим ожидаемый регрет по сравнению с двумя экспертами. Предположим, что вероятность исхода 1 равна $p$. Тогда для эксперта, всегда выбирающего исход 0, и эксперта, всегда выбирающего исход 1, ожидаемый регрет равен соответственно:

$$R_0(T) = \mathbb{E}\left[\sum_{t=1}^{T} l\left(y_t, 0\right)\right] = Tp$$

$$R_0(T) = \mathbb{E}\left[\sum_{t=1}^{T} l\left(y_t, 1\right)\right] = T(1 - p)$$

Тогда оценка среднего ожидаемого регрета для нашего алгоритма будет следующей:

$$R_0(T) \le \sum_{t=1}^{T}\mathbb{E}\left[l\left(y, \hat{y_t}\right)\right] = \sum_{t=1}^{T}\mathbb{E}\left|\hat{p_t} - p\right| = \sum_{t=1}^{T}\mathbb{E}\left|\hat{p_t} - \frac{1}{2}\right| + \frac{1}{2}$$

где $\hat{p_t}$ - это оценка вероятности исхода 1 на момент времени $t$.

Эту оценку можно построить следующим образом:

$$\hat{p} = \frac{\sum_{i = 1}^{t - 1} y_i + \frac{1}{2}}{t}$$

Таким образом, средний ожидаемый регрет нашего алгоритма будет оцениваться следующим образом:

$$R(T) \leq \sum_{t=1}^T \left(\mathbb{E}\left|\hat{p_t}-\frac{1}{2}\right| + \frac{1}{2}\right) = \sum_{t=1}^T \mathbb{E}\left|\hat{p_t}-\frac{1}{2}\right| + \frac{T}{2}$$

Для алгоритма взвешенного большинства (или просто большинства), который просто выбирает исход, который получил большинство голосов на всех предыдущих шагах, ожидаемый регрет можно оценить следующим образом:

$$R_{maj}(T) \leq \min(p, 1-p)T$$

То есть ошибка будет равна вероятности того, что мажоритарный исход был выбран неверно, умноженной на число шагов. В данном случае, мажоритарный исход будет выбран неверно в ситуации, когда количество исходов 0 и 1 равно, что происходит с вероятностью $\frac{1}{2}$. Таким образом, сравнение ожидаемого регрета нашего алгоритма и алгоритма взвешенного большинства будет зависеть от значения $p$. Если $p\approx 0$ или $p\approx 1$, то наш алгоритм будет лучше, так как он будет стремиться выбирать исходы ближе к истинному значению $p$. Если $p\approx \frac{1}{2}$, то алгоритм взвешенного большинства будет лучше, так как он не будет зависеть от вероятности исхода и будет всегда выбирать мажоритарный исход.
Относительно возможности сделать средний ожидаемый регрет сколь угодно малым с течением времени для алгоритма взвешенного большинства, ответ зависит от того, насколько быстро расходится оценка вероятности исхода в нашем алгоритме. Если оценка быстро сходится к истинному значению вероятности, то ожидаемый регрет будет стремиться к нулю с ростом числа шагов. Однако, если оценка сходится медленно, то ожидаемый регрет может оставаться значительным даже при большом числе шагов.
Итак, для выбора лучшего алгоритма в конкретной ситуации нужно знать вероятность исхода $p$ и оценить, насколько быстро сходится оценка вероятности в нашем алгоритме. Если $p\approx 0$ или $p\approx 1$ и оценка быстро сходится, то наш алгоритм будет лучше, так как он будет стремиться выбирать исходы ближе к истинному значению вероятности. Если $p\approx \frac{1}{2}$, то алгоритм взвешенного большинства будет лучше, так как он не будет зависеть от вероятности исхода и будет всегда выбирать мажоритарный исход.

Кроме того, стоит учесть, что наш алгоритм требует большего вычислительного ресурса, так как мы должны вычислять оценку вероятности на каждом шаге. Если скорость выполнения является важным фактором, то алгоритм взвешенного большинства может оказаться более предпочтительным в этом случае.

В целом, выбор лучшего алгоритма зависит от конкретной ситуации и требует учета различных факторов, таких как вероятность исхода, скорость выполнения, и требования к точности прогнозов.

\end{document}
